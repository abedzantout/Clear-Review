<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Typeahead Game_v3 Demo</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.8/semantic.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/awesome-bootstrap-checkbox/0.3.7/awesome-bootstrap-checkbox.css">
    <link rel="stylesheet" href="stylesheets/libraries/jquery.typeahead.css">

    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="javascripts/libraries/jquery.typeahead.js"></script>

    <style>

        #form-game_v2 .typeahead__container.backdrop {
            position: fixed !important;
            width: 80%;
            left: 10%;
            top: 50px;
        }

        #form-game_v2 .typeahead__container.backdrop .typeahead__query input {
            font-size: 3rem;
            height: auto;
            color: #333;
        }

        #form-game_v2 .typeahead__container.backdrop .typeahead__button {
            display: none;
        }

        #form-game_v2 li.typeahead__group {
            padding: 10px 10px 0;
        }

        #form-game_v2 li.typeahead__item {
            display: inline-block;
            font-size: 0;
            border: 0;
            position: relative;
            margin: 5px;
        }

        #form-game_v2 li.typeahead__item span.title {
            display: none;
            position: absolute;
            bottom: 0;
            width: 100%;
            text-transform: capitalize;
            border-radius: 0;
        }

        #form-game_v2 li.typeahead__item:hover span.title,
        #form-game_v2 li.typeahead__item.active span.title {
            display: block;
        }

        #form-game_v2 li.typeahead__item span {
            font-size: 1rem;
            background: #fff;
            padding: 2px 5px;
            border-radius: 10px;
        }

        #form-game_v2 .typeahead__list {
            background: #fff;
            overflow-x: hidden;
            overflow-y: auto;
        }

        #form-game_v2 .typeahead__list a {
            padding: 1px;
        }

        #form-game_v2 .typeahead__list .typeahead__item a:hover {
            background: transparent;
        }

        #form-game_v2 .typeahead__list .typeahead__item a img {
            border: solid 1px transparent;
            width: 178px;
        }

        #form-game_v2 .typeahead__list .typeahead__item a:hover img,
        #form-game_v2 .typeahead__list .typeahead__item.active a img {
            border-color: #4D90FE;
        }

        #form-game_v2 .typeahead__list .typeahead__item a:hover span {
            opacity: .8;
        }

        #form-game_v2 .typeahead__group a {
            background: transparent;
            font-size: 1.5rem;
            text-transform: uppercase;
            color: #ccc;
        }

        #form-game_v2 .ui.label {
            text-transform: capitalize;
        }

    </style>




</head>
<body>

<form id="form-game_v2" name="form-game_v2">
    <div class="typeahead__container">
        <div class="typeahead__field">

            <span class="typeahead__query">
                <input class="js-typeahead-game_v2" name="game_v2[query]" placeholder="Search" autocomplete="off" type="search">
            </span>
            <span class="typeahead__button">
                <button type="submit">
                    <i class="typeahead__search-icon"></i>
                </button>
            </span>

        </div>
    </div>
</form>


<script>
    window.onresize = function(event) {
        if ($('#form-game_v2').find('> .typeahead__container.backdrop')) {
            $('#form-game_v2').find('.typeahead__list').css('max-height', $(window).height() - 200 + "px")
        }
    }

    $.typeahead({
        input: '.js-typeahead-game_v2',
        minLength: 1,
        maxItem: false,
        highlight: false,
        hint: true,
        group: true,
        maxItemPerGroup: 16,
        backdrop: {
            "background-color": "#fff"
        },
        backdropOnFocus: true,
        cache: "sessionStorage",
        compression: true,
        cancelButton: false,
        template: function () {
            return '<span class="ui blue small label">{{display}}</span>';
        },
        source: {
            game: {
                href: "http://www.gamer-hub.com/game/{{id}}/{{display|slugify}}/",
                template: function (query, item) {
                    return '<img src="http://cdn.gamer-hub.com/images/' + this.helper.slugify.call(this, item.display) + '.jpg">' +
                            '<span class="title">{{display}}</span>';
                },
                ajax: {
                    url: "http://www.gamer-hub.com/game/list.json",
                    dataType: "jsonp",
                    path: "data"
                }
            },
            tag: {
                href: "http://www.gamer-hub.com/tag/{{id}}/{{display|slugify}}/",
                ajax: {
                    url: "http://www.gamer-hub.com/tag/list.json",
                    dataType: "jsonp",
                    path: "data"
                }
            },
            category: {
                href: "http://www.gamer-hub.com/category/{{id}}/{{display|slugify}}/",
                ajax: {
                    url: "http://www.gamer-hub.com/category/list.json",
                    dataType: "jsonp",
                    path: "data"
                }
            }
        },
        callback: {
            onShowLayout: function (node, query) {
                node.attr('placeholder', 'Search for a Game ...');
                node.closest('form').find('.typeahead__list').css('max-height', $(window).height() - 200 + "px");
            },
            onHideLayout: function (node, query) {
                node.attr('placeholder', 'Search');
            },
            onLayoutBuiltBefore: function (node, query, result, resultHtmlList) {
                resultHtmlList.find('li[data-search-group="game"]').remove();
                return resultHtmlList;
            },
            onClickAfter: function (node, a, item, event) {

                event.preventDefault();

                var r = confirm("You will be redirected to:\n" + item.href + "\n\nContinue?");
                if (r == true) {
                    window.open(item.href);
                }

            }
        }
    })
</script>
</body>
</html>